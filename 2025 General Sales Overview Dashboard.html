<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Profit Analysis Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }
        
        .dashboard {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        
        .kpi-label {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }
        
        .kpi-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .kpi-subtext {
            font-size: 0.85em;
            color: #888;
            margin-top: 5px;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .chart-card.full-width {
            grid-column: 1 / -1;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
        }
        
        .insights {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 20px;
        }
        
        .insights h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .insight-item {
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .insight-item strong {
            color: #667eea;
        }
        
        .positive {
            color: #28a745;
        }
        
        .negative {
            color: #dc3545;
        }
        
        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        
        .filter-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #667eea;
        }
        
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            cursor: pointer;
        }
        
        select:focus {
            outline: none;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>üìä Sales Profit Analysis Dashboard</h1>
            <p class="subtitle">Comprehensive analysis of venues, events, and profit trends</p>
        </div>
        
        <div class="kpi-container">
            <div class="kpi-card">
                <div class="kpi-label">Total Profit</div>
                <div class="kpi-value" id="totalProfit">$0</div>
                <div class="kpi-subtext" id="profitMargin">0% margin</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Total Revenue</div>
                <div class="kpi-value" id="totalRevenue">$0</div>
                <div class="kpi-subtext" id="totalTransactions">0 transactions</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Avg Profit/Transaction</div>
                <div class="kpi-value" id="avgProfit">$0</div>
                <div class="kpi-subtext" id="profitableRate">0% profitable</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Total Cost</div>
                <div class="kpi-value" id="totalCost">$0</div>
                <div class="kpi-subtext" id="unprofitableCount">0 unprofitable</div>
            </div>
        </div>
        
        <div class="chart-grid">
            <div class="chart-card full-width">
                <h3 class="chart-title">üèüÔ∏è Top 20 Venues by Profit</h3>
                <div class="chart-container">
                    <canvas id="venueChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card full-width">
                <h3 class="chart-title">üé≠ Top 20 Events by Profit</h3>
                <div class="chart-container">
                    <canvas id="eventChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">üìà Monthly Profit Trend</h3>
                <div class="chart-container">
                    <canvas id="monthlyChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">üé´ Profit by Ticket Quantity</h3>
                <div class="chart-container">
                    <canvas id="quantityChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">üë• Top 10 Customers by Profit</h3>
                <div class="chart-container">
                    <canvas id="customerChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">üìä Venue Profit Margin Analysis</h3>
                <div class="chart-container">
                    <canvas id="marginChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="insights">
            <h2>üí° Key Insights & Opportunities</h2>
            <div id="insightsContainer"></div>
        </div>
    </div>

    <script>
        // Load data
        const dashboardData = {"summary": {"total_transactions": 19468, "profitable_transactions": 17375, "unprofitable_transactions": 2093, "total_revenue": 8479553.62, "total_cost": 7586953.529999999, "total_profit": 892592.51, "avg_profit": 45.849214608588454, "overall_margin": 10.526409171996015, "profitable_pct": 89.24902403944935}, "venues": [{"Venue": "Madison Square Garden", "Profit": 66833.74, "Total": 679293.63, "Quantity": 1183, "PO #": 600, "Avg Profit": 111.39, "Profit Margin %": 9.84}, {"Venue": "American Airlines Center - TX", "Profit": 44803.89, "Total": 367771.78, "Quantity": 1327, "PO #": 625, "Avg Profit": 71.69, "Profit Margin %": 12.18}, {"Venue": "Chase Center", "Profit": 35430.59, "Total": 330708.44, "Quantity": 982, "PO #": 470, "Avg Profit": 75.38, "Profit Margin %": 10.71}, {"Venue": "Gainbridge Fieldhouse", "Profit": 35126.72, "Total": 397619.31, "Quantity": 359, "PO #": 170, "Avg Profit": 206.63, "Profit Margin %": 8.83}, {"Venue": "TD Garden", "Profit": 28263.05, "Total": 300035.65, "Quantity": 868, "PO #": 427, "Avg Profit": 66.19, "Profit Margin %": 9.42}, {"Venue": "Capital One Arena", "Profit": 18767.44, "Total": 158155.72, "Quantity": 517, "PO #": 263, "Avg Profit": 71.36, "Profit Margin %": 11.87}, {"Venue": "Crypto.com Arena", "Profit": 18356.71, "Total": 173729.55, "Quantity": 442, "PO #": 225, "Avg Profit": 81.59, "Profit Margin %": 10.57}, {"Venue": "Mercedes-Benz Stadium", "Profit": 18246.99, "Total": 180471.74, "Quantity": 512, "PO #": 239, "Avg Profit": 76.35, "Profit Margin %": 10.11}, {"Venue": "Hard Rock Stadium", "Profit": 17591.74, "Total": 139996.74, "Quantity": 274, "PO #": 131, "Avg Profit": 134.29, "Profit Margin %": 12.57}, {"Venue": "Little Caesars Arena", "Profit": 16764.4, "Total": 155504.92, "Quantity": 605, "PO #": 276, "Avg Profit": 60.74, "Profit Margin %": 10.78}, {"Venue": "Ball Arena", "Profit": 16007.08, "Total": 132001.32, "Quantity": 503, "PO #": 244, "Avg Profit": 65.6, "Profit Margin %": 12.13}, {"Venue": "Ohio Stadium", "Profit": 15615.61, "Total": 139797.19, "Quantity": 313, "PO #": 160, "Avg Profit": 97.6, "Profit Margin %": 11.17}, {"Venue": "Xfinity Mobile Arena", "Profit": 15062.69, "Total": 141572.55, "Quantity": 643, "PO #": 302, "Avg Profit": 49.88, "Profit Margin %": 10.64}, {"Venue": "Arthur Ashe Stadium", "Profit": 12836.85, "Total": 92923.01, "Quantity": 84, "PO #": 34, "Avg Profit": 377.55, "Profit Margin %": 13.81}, {"Venue": "Dickies Arena", "Profit": 12802.67, "Total": 93281.45, "Quantity": 350, "PO #": 139, "Avg Profit": 92.11, "Profit Margin %": 13.72}, {"Venue": "Mortgage Matchup Center", "Profit": 12748.88, "Total": 104229.48, "Quantity": 392, "PO #": 208, "Avg Profit": 61.29, "Profit Margin %": 12.23}, {"Venue": "Scotiabank Arena", "Profit": 12183.93, "Total": 109135.94, "Quantity": 322, "PO #": 162, "Avg Profit": 75.21, "Profit Margin %": 11.16}, {"Venue": "United Center", "Profit": 11313.85, "Total": 124147.66, "Quantity": 401, "PO #": 192, "Avg Profit": 58.93, "Profit Margin %": 9.11}, {"Venue": "Barclays Center", "Profit": 10542.25, "Total": 108182.22, "Quantity": 309, "PO #": 172, "Avg Profit": 61.29, "Profit Margin %": 9.74}, {"Venue": "Sphere", "Profit": 10315.99, "Total": 87278.91, "Quantity": 149, "PO #": 80, "Avg Profit": 128.95, "Profit Margin %": 11.82}], "events": [{"Event": "Indiana Pacers vs. New York Knicks", "Profit": 19467.32, "Total": 230544.37, "Quantity": 48, "PO #": 23, "Avg Profit": 846.41, "Profit Margin %": 8.44}, {"Event": "US Open Tennis", "Profit": 13033.17, "Total": 95445.37, "Quantity": 86, "PO #": 34, "Avg Profit": 383.33, "Profit Margin %": 13.66}, {"Event": "New York Knicks vs. Indiana Pacers", "Profit": 12295.0, "Total": 144594.9, "Quantity": 30, "PO #": 14, "Avg Profit": 878.21, "Profit Margin %": 8.5}, {"Event": "Capital One Orange Bowl", "Profit": 11560.25, "Total": 88736.37, "Quantity": 137, "PO #": 52, "Avg Profit": 222.31, "Profit Margin %": 13.03}, {"Event": "Ohio State Football vs. Texas Longhorns Football", "Profit": 8592.47, "Total": 79940.12, "Quantity": 80, "PO #": 35, "Avg Profit": 245.5, "Profit Margin %": 10.75}, {"Event": "SEC Championship", "Profit": 8346.11, "Total": 91394.23, "Quantity": 118, "PO #": 45, "Avg Profit": 185.47, "Profit Margin %": 9.13}, {"Event": "Lady Gaga", "Profit": 7942.56, "Total": 75453.38, "Quantity": 58, "PO #": 34, "Avg Profit": 233.6, "Profit Margin %": 10.53}, {"Event": "Golden State Warriors vs. Oklahoma City Thunder", "Profit": 7459.54, "Total": 56414.44, "Quantity": 81, "PO #": 34, "Avg Profit": 219.4, "Profit Margin %": 13.22}, {"Event": "Sugar Bowl", "Profit": 7430.65, "Total": 72211.24, "Quantity": 139, "PO #": 55, "Avg Profit": 135.1, "Profit Margin %": 10.29}, {"Event": "Indiana Pacers vs. Oklahoma City Thunder", "Profit": 6780.41, "Total": 77968.12, "Quantity": 24, "PO #": 13, "Avg Profit": 521.57, "Profit Margin %": 8.7}, {"Event": "Backstreet Boys", "Profit": 5714.01, "Total": 50826.69, "Quantity": 61, "PO #": 35, "Avg Profit": 163.26, "Profit Margin %": 11.24}, {"Event": "Coldplay", "Profit": 5237.48, "Total": 40038.38, "Quantity": 47, "PO #": 24, "Avg Profit": 218.23, "Profit Margin %": 13.08}, {"Event": "The Weeknd w/ Playboi Carti", "Profit": 5207.28, "Total": 41564.21, "Quantity": 126, "PO #": 90, "Avg Profit": 57.86, "Profit Margin %": 12.53}, {"Event": "New York Knicks vs. Boston Celtics", "Profit": 4850.13, "Total": 55611.68, "Quantity": 38, "PO #": 19, "Avg Profit": 255.27, "Profit Margin %": 8.72}, {"Event": "FIFA Club World Cup Soccer", "Profit": 4589.16, "Total": 52301.69, "Quantity": 293, "PO #": 173, "Avg Profit": 26.53, "Profit Margin %": 8.77}, {"Event": "NCAA College World Series", "Profit": 4360.93, "Total": 52897.9, "Quantity": 272, "PO #": 114, "Avg Profit": 38.25, "Profit Margin %": 8.24}, {"Event": "Morgan Wallen w/ Miranda Lambert", "Profit": 4229.77, "Total": 30358.1, "Quantity": 36, "PO #": 20, "Avg Profit": 211.49, "Profit Margin %": 13.93}, {"Event": "Dallas Mavericks vs. Houston Rockets", "Profit": 4088.71, "Total": 30815.3, "Quantity": 62, "PO #": 26, "Avg Profit": 157.26, "Profit Margin %": 13.27}, {"Event": "Beyonce", "Profit": 4050.31, "Total": 31054.91, "Quantity": 70, "PO #": 48, "Avg Profit": 84.38, "Profit Margin %": 13.04}, {"Event": "Paul McCartney", "Profit": 3813.49, "Total": 26204.58, "Quantity": 30, "PO #": 19, "Avg Profit": 200.71, "Profit Margin %": 14.55}], "monthly": [{"Sale Month": "2025-01", "Profit": 27987.72, "Total": 302238.13, "PO #": 871}, {"Sale Month": "2025-02", "Profit": 30952.74, "Total": 279155.25, "PO #": 928}, {"Sale Month": "2025-03", "Profit": 35168.67, "Total": 233022.34, "PO #": 609}, {"Sale Month": "2025-04", "Profit": 28855.26, "Total": 278302.25, "PO #": 591}, {"Sale Month": "2025-05", "Profit": 82924.85, "Total": 822696.71, "PO #": 962}, {"Sale Month": "2025-06", "Profit": 60293.91, "Total": 473675.75, "PO #": 1076}, {"Sale Month": "2025-07", "Profit": 42397.86, "Total": 413147.65, "PO #": 1193}, {"Sale Month": "2025-08", "Profit": 59921.4, "Total": 559504.88, "PO #": 1318}, {"Sale Month": "2025-09", "Profit": 54682.68, "Total": 518264.22, "PO #": 1374}, {"Sale Month": "2025-10", "Profit": 101995.21, "Total": 1002035.71, "PO #": 2298}, {"Sale Month": "2025-11", "Profit": 147555.15, "Total": 1426507.24, "PO #": 3850}, {"Sale Month": "2025-12", "Profit": 219857.06, "Total": 2171003.49, "PO #": 4398}], "quantity": [{"Quantity": 1, "Total Profit": 20985.68, "Avg Profit": 3.5, "Transaction Count": 5991}, {"Quantity": 2, "Total Profit": 557394.21, "Avg Profit": 54.18, "Transaction Count": 10288}, {"Quantity": 3, "Total Profit": 128328.6, "Avg Profit": 84.21, "Transaction Count": 1524}, {"Quantity": 4, "Total Profit": 132090.99, "Avg Profit": 103.2, "Transaction Count": 1280}, {"Quantity": 5, "Total Profit": 24406.11, "Avg Profit": 102.98, "Transaction Count": 237}, {"Quantity": 6, "Total Profit": 8448.3, "Avg Profit": 118.99, "Transaction Count": 71}, {"Quantity": 7, "Total Profit": 17705.28, "Avg Profit": 334.06, "Transaction Count": 53}, {"Quantity": 8, "Total Profit": 966.08, "Avg Profit": 74.31, "Transaction Count": 13}, {"Quantity": 9, "Total Profit": 470.84, "Avg Profit": 470.84, "Transaction Count": 1}, {"Quantity": 10, "Total Profit": 939.2, "Avg Profit": 156.53, "Transaction Count": 6}, {"Quantity": 11, "Total Profit": 694.21, "Avg Profit": 231.4, "Transaction Count": 3}, {"Quantity": 14, "Total Profit": 163.01, "Avg Profit": 163.01, "Transaction Count": 1}], "customers": [{"Customer": "Seatgeek PRD", "Profit": 378632.25, "Total": 2977436.18, "PO #": 6975}, {"Customer": "SeatGeek PRD", "Profit": 306523.24, "Total": 2694616.77, "PO #": 5851}, {"Customer": "SeatGeek", "Profit": 271665.63, "Total": 2348565.09, "PO #": 4372}, {"Customer": "Tickpick PRD", "Profit": 20380.0, "Total": 350302.37, "PO #": 828}, {"Customer": "DRJ Technologies LLC", "Profit": -79.57, "Total": 0.0, "PO #": 1}, {"Customer": "Ticketnetwork PRD", "Profit": -441.6, "Total": 2941.85, "PO #": 44}, {"Customer": "Automatiq B2B", "Profit": -470.25, "Total": 472.48, "PO #": 6}, {"Customer": "Ticket Evolution", "Profit": -526.03, "Total": 1035.54, "PO #": 13}, {"Customer": "Premium Seats USA, PSUSA", "Profit": -713.45, "Total": 3029.63, "PO #": 10}, {"Customer": "Ticket Network", "Profit": -750.98, "Total": 1207.57, "PO #": 23}]};
        
        // Format currency
        const formatCurrency = (val) => {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(val);
        };
        
        // Format number
        const formatNumber = (val) => {
            return new Intl.NumberFormat('en-US').format(val);
        };
        
        // Update KPIs
        document.getElementById('totalProfit').textContent = formatCurrency(dashboardData.summary.total_profit);
        document.getElementById('profitMargin').textContent = dashboardData.summary.overall_margin.toFixed(2) + '% margin';
        document.getElementById('totalRevenue').textContent = formatCurrency(dashboardData.summary.total_revenue);
        document.getElementById('totalTransactions').textContent = formatNumber(dashboardData.summary.total_transactions) + ' transactions';
        document.getElementById('avgProfit').textContent = formatCurrency(dashboardData.summary.avg_profit);
        document.getElementById('profitableRate').textContent = dashboardData.summary.profitable_pct.toFixed(1) + '% profitable';
        document.getElementById('totalCost').textContent = formatCurrency(dashboardData.summary.total_cost);
        document.getElementById('unprofitableCount').textContent = formatNumber(dashboardData.summary.unprofitable_transactions) + ' unprofitable';
        
        // Chart configurations
        const chartColors = {
            primary: 'rgba(102, 126, 234, 0.8)',
            secondary: 'rgba(118, 75, 162, 0.8)',
            success: 'rgba(40, 167, 69, 0.8)',
            danger: 'rgba(220, 53, 69, 0.8)',
            warning: 'rgba(255, 193, 7, 0.8)',
            info: 'rgba(23, 162, 184, 0.8)'
        };
        
        // 1. Venue Chart
        const venueCtx = document.getElementById('venueChart').getContext('2d');
        new Chart(venueCtx, {
            type: 'bar',
            data: {
                labels: dashboardData.venues.map(v => v.Venue),
                datasets: [{
                    label: 'Total Profit',
                    data: dashboardData.venues.map(v => v.Profit),
                    backgroundColor: chartColors.primary,
                    borderColor: chartColors.primary,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const venue = dashboardData.venues[context.dataIndex];
                                return [
                                    'Profit: ' + formatCurrency(venue.Profit),
                                    'Revenue: ' + formatCurrency(venue.Total),
                                    'Transactions: ' + formatNumber(venue['PO #']),
                                    'Margin: ' + venue['Profit Margin %'].toFixed(1) + '%'
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + (value/1000).toFixed(0) + 'K';
                            }
                        }
                    },
                    x: {
                        ticks: {
                            autoSkip: false,
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        // 2. Event Chart
        const eventCtx = document.getElementById('eventChart').getContext('2d');
        new Chart(eventCtx, {
            type: 'bar',
            data: {
                labels: dashboardData.events.map(e => e.Event.length > 40 ? e.Event.substring(0, 40) + '...' : e.Event),
                datasets: [{
                    label: 'Total Profit',
                    data: dashboardData.events.map(e => e.Profit),
                    backgroundColor: chartColors.secondary,
                    borderColor: chartColors.secondary,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const event = dashboardData.events[context.dataIndex];
                                return [
                                    'Profit: ' + formatCurrency(event.Profit),
                                    'Revenue: ' + formatCurrency(event.Total),
                                    'Transactions: ' + formatNumber(event['PO #']),
                                    'Margin: ' + event['Profit Margin %'].toFixed(1) + '%'
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + (value/1000).toFixed(0) + 'K';
                            }
                        }
                    },
                    x: {
                        ticks: {
                            autoSkip: false,
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        // 3. Monthly Chart
        const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
        new Chart(monthlyCtx, {
            type: 'line',
            data: {
                labels: dashboardData.monthly.map(m => m['Sale Month']),
                datasets: [{
                    label: 'Monthly Profit',
                    data: dashboardData.monthly.map(m => m.Profit),
                    borderColor: chartColors.success,
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const month = dashboardData.monthly[context.dataIndex];
                                return [
                                    'Profit: ' + formatCurrency(month.Profit),
                                    'Revenue: ' + formatCurrency(month.Total),
                                    'Transactions: ' + formatNumber(month['PO #'])
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });
        
        // 4. Quantity Chart
        const quantityCtx = document.getElementById('quantityChart').getContext('2d');
        new Chart(quantityCtx, {
            type: 'bar',
            data: {
                labels: dashboardData.quantity.map(q => q.Quantity + ' tickets'),
                datasets: [{
                    label: 'Total Profit',
                    data: dashboardData.quantity.map(q => q['Total Profit']),
                    backgroundColor: chartColors.warning,
                    borderColor: chartColors.warning,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const qty = dashboardData.quantity[context.dataIndex];
                                return [
                                    'Total Profit: ' + formatCurrency(qty['Total Profit']),
                                    'Avg Profit: ' + formatCurrency(qty['Avg Profit']),
                                    'Transactions: ' + formatNumber(qty['Transaction Count'])
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });
        
        // 5. Customer Chart
        const customerCtx = document.getElementById('customerChart').getContext('2d');
        new Chart(customerCtx, {
            type: 'doughnut',
            data: {
                labels: dashboardData.customers.map(c => c.Customer),
                datasets: [{
                    data: dashboardData.customers.map(c => c.Profit),
                    backgroundColor: [
                        'rgba(102, 126, 234, 0.8)',
                        'rgba(118, 75, 162, 0.8)',
                        'rgba(40, 167, 69, 0.8)',
                        'rgba(255, 193, 7, 0.8)',
                        'rgba(220, 53, 69, 0.8)',
                        'rgba(23, 162, 184, 0.8)',
                        'rgba(108, 117, 125, 0.8)',
                        'rgba(253, 126, 20, 0.8)',
                        'rgba(233, 30, 99, 0.8)',
                        'rgba(156, 39, 176, 0.8)'
                    ],
                    borderWidth: 2,
                    borderColor: 'white'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const customer = dashboardData.customers[context.dataIndex];
                                return [
                                    customer.Customer,
                                    'Profit: ' + formatCurrency(customer.Profit),
                                    'Transactions: ' + formatNumber(customer['PO #'])
                                ];
                            }
                        }
                    },
                    legend: {
                        position: 'right'
                    }
                }
            }
        });
        
        // 6. Margin Chart
        const marginCtx = document.getElementById('marginChart').getContext('2d');
        const top10Venues = dashboardData.venues.slice(0, 10);
        new Chart(marginCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Venues',
                    data: top10Venues.map(v => ({
                        x: v['PO #'],
                        y: v['Profit Margin %'],
                        r: Math.sqrt(v.Profit) / 10
                    })),
                    backgroundColor: chartColors.info
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const venue = top10Venues[context.dataIndex];
                                return [
                                    venue.Venue,
                                    'Margin: ' + venue['Profit Margin %'].toFixed(1) + '%',
                                    'Transactions: ' + formatNumber(venue['PO #']),
                                    'Profit: ' + formatCurrency(venue.Profit)
                                ];
                            }
                        }
                    },
                    legend: {
                        display: false
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Number of Transactions'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Profit Margin %'
                        }
                    }
                }
            }
        });
        
        // Generate insights
        const insights = [];
        
        // Top venue
        const topVenue = dashboardData.venues[0];
        insights.push(`<strong>Best Venue:</strong> ${topVenue.Venue} generated ${formatCurrency(topVenue.Profit)} in profit with a ${topVenue['Profit Margin %'].toFixed(1)}% margin across ${formatNumber(topVenue['PO #'])} transactions.`);
        
        // Top event
        const topEvent = dashboardData.events[0];
        insights.push(`<strong>Best Event:</strong> ${topEvent.Event} brought in ${formatCurrency(topEvent.Profit)} profit with ${formatNumber(topEvent.Quantity)} tickets sold.`);
        
        // Profitability rate
        insights.push(`<strong>Success Rate:</strong> ${dashboardData.summary.profitable_pct.toFixed(1)}% of transactions were profitable, with ${formatNumber(dashboardData.summary.unprofitable_transactions)} transactions resulting in losses.`);
        
        // Quantity insight
        const bestQuantity = dashboardData.quantity.reduce((max, q) => q['Avg Profit'] > max['Avg Profit'] ? q : max);
        insights.push(`<strong>Optimal Quantity:</strong> Selling ${bestQuantity.Quantity} tickets at a time yields the highest average profit of ${formatCurrency(bestQuantity['Avg Profit'])} per transaction.`);
        
        // Monthly trend
        const recentMonths = dashboardData.monthly.slice(-3);
        const trend = recentMonths[2].Profit > recentMonths[0].Profit ? 'increasing' : 'decreasing';
        const trendClass = trend === 'increasing' ? 'positive' : 'negative';
        insights.push(`<strong>Recent Trend:</strong> Profit has been <span class="${trendClass}">${trend}</span> over the last 3 months.`);
        
        // Low margin venues
        const lowMarginVenues = dashboardData.venues.filter(v => v['Profit Margin %'] < 5);
        if (lowMarginVenues.length > 0) {
            insights.push(`<strong>Opportunity Alert:</strong> ${lowMarginVenues.length} venues have profit margins below 5%. Consider reviewing pricing or cost structures for these locations.`);
        }
        
        // High volume opportunities
        const highVolumeVenues = dashboardData.venues.filter(v => v['PO #'] > 100 && v['Profit Margin %'] > 15);
        if (highVolumeVenues.length > 0) {
            insights.push(`<strong>Golden Opportunities:</strong> ${highVolumeVenues.length} venues combine high transaction volume with strong margins (>15%). Focus on expanding inventory at these locations.`);
        }
        
        // Display insights
        const insightsContainer = document.getElementById('insightsContainer');
        insights.forEach(insight => {
            const div = document.createElement('div');
            div.className = 'insight-item';
            div.innerHTML = insight;
            insightsContainer.appendChild(div);
        });
    </script>
</body>
</html>