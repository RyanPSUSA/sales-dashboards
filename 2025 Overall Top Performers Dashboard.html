<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Venues & Events Deep Dive Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }
        
        .dashboard {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 2.8em;
            font-weight: 700;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2em;
            line-height: 1.6;
        }
        
        .nav-tabs {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #f0f0f0;
            color: #333;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .tab-button:hover {
            background: #e0e0e0;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        
        .kpi-label {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }
        
        .kpi-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .kpi-subtext {
            font-size: 0.85em;
            color: #888;
            margin-top: 8px;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .chart-card.full-width {
            grid-column: 1 / -1;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
        }
        
        .chart-container.tall {
            height: 500px;
        }
        
        .detail-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .venue-card, .event-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
        }
        
        .venue-card h3, .event-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .positive {
            color: #28a745;
            font-weight: 600;
        }
        
        .negative {
            color: #dc3545;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>üèÜ Top Performers Deep Dive</h1>
            <p class="subtitle">
                Advanced analysis of your top 10 venues by transaction volume (3,722 transactions) 
                and top 10 events by transaction volume (835 transactions). 
                Discover patterns, opportunities, and performance insights from your highest-activity locations and events.
            </p>
        </div>
        
        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('overview')">üìä Overview</button>
            <button class="tab-button" onclick="showTab('venues')">üèüÔ∏è Venue Deep Dive</button>
            <button class="tab-button" onclick="showTab('events')">üé≠ Event Deep Dive</button>
            <button class="tab-button" onclick="showTab('comparison')">üìà Comparison Analysis</button>
            <button class="tab-button" onclick="showTab('matrix')">üîó Venue-Event Matrix</button>
        </div>
        
        <!-- OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <h2 style="color: white; margin-bottom: 15px; font-size: 1.8em;">Top Venues Performance</h2>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Total Transactions</div>
                    <div class="kpi-value" id="venuesTransactions">0</div>
                    <div class="kpi-subtext">From 10 venues</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Total Profit</div>
                    <div class="kpi-value" id="venuesProfit">$0</div>
                    <div class="kpi-subtext" id="venuesMargin">0% margin</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Avg Profit/Trans</div>
                    <div class="kpi-value" id="venuesAvgProfit">$0</div>
                    <div class="kpi-subtext" id="venuesProfitableRate">0% profitable</div>
                </div>
            </div>
            
            <h2 style="color: white; margin-bottom: 15px; margin-top: 30px; font-size: 1.8em;">Top Events Performance</h2>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Total Transactions</div>
                    <div class="kpi-value" id="eventsTransactions">0</div>
                    <div class="kpi-subtext">From 10 events</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Total Profit</div>
                    <div class="kpi-value" id="eventsProfit">$0</div>
                    <div class="kpi-subtext" id="eventsMargin">0% margin</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Avg Profit/Trans</div>
                    <div class="kpi-value" id="eventsAvgProfit">$0</div>
                    <div class="kpi-subtext" id="eventsProfitableRate">0% profitable</div>
                </div>
            </div>
            
            <div class="chart-grid">
                <div class="chart-card">
                    <h3 class="chart-title">Top 10 Venues by Transaction Volume</h3>
                    <div class="chart-container">
                        <canvas id="venuesOverviewChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Top 10 Events by Transaction Volume</h3>
                    <div class="chart-container">
                        <canvas id="eventsOverviewChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- VENUES TAB -->
        <div id="venues" class="tab-content">
            <div class="chart-grid">
                <div class="chart-card full-width">
                    <h3 class="chart-title">Venue Profitability Comparison</h3>
                    <div class="chart-container">
                        <canvas id="venueProfitChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Venue Profit Margins</h3>
                    <div class="chart-container">
                        <canvas id="venueMarginChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Avg Ticket Price by Venue</h3>
                    <div class="chart-container">
                        <canvas id="venuePriceChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h2 class="section-title">Individual Venue Details</h2>
                <div id="venueDetailsContainer"></div>
            </div>
        </div>
        
        <!-- EVENTS TAB -->
        <div id="events" class="tab-content">
            <div class="chart-grid">
                <div class="chart-card full-width">
                    <h3 class="chart-title">Event Profitability Comparison</h3>
                    <div class="chart-container">
                        <canvas id="eventProfitChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Event Profit Margins</h3>
                    <div class="chart-container">
                        <canvas id="eventMarginChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Total Tickets Sold by Event</h3>
                    <div class="chart-container">
                        <canvas id="eventTicketsChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h2 class="section-title">Individual Event Details</h2>
                <div id="eventDetailsContainer"></div>
            </div>
        </div>
        
        <!-- COMPARISON TAB -->
        <div id="comparison" class="tab-content">
            <div class="chart-grid">
                <div class="chart-card full-width">
                    <h3 class="chart-title">Venue Performance Matrix</h3>
                    <div class="chart-container tall">
                        <canvas id="venueScatterChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card full-width">
                    <h3 class="chart-title">Complete Venue Comparison</h3>
                    <table id="venueComparisonTable"></table>
                </div>
                
                <div class="chart-card full-width">
                    <h3 class="chart-title">Complete Event Comparison</h3>
                    <table id="eventComparisonTable"></table>
                </div>
            </div>
        </div>
        
        <!-- MATRIX TAB -->
        <div id="matrix" class="tab-content">
            <div class="detail-section">
                <h2 class="section-title">üîó Venue-Event Performance Matrix</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    Shows which events perform best at which venues. Minimum 3 transactions required.
                </p>
                <table id="venueEventMatrixTable"></table>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // Load data
        const data = {"top_venues_summary": {"total_transactions": 3722, "total_profit": 256535.86, "total_revenue": 2402929.8, "avg_profit": 68.92419666845781, "profit_margin": 10.6759614866818, "profitable_pct": 95.80870499731327}, "top_events_summary": {"total_transactions": 835, "total_profit": 34807.54, "total_revenue": 365275.61, "avg_profit": 41.68567664670659, "profit_margin": 9.529116931732727, "profitable_pct": 88.74251497005989}, "venue_details": [{"Venue": "American Airlines Center - TX", "Total_Transactions": 625, "Total_Profit": 44803.89, "Total_Revenue": 367771.77999999997, "Avg_Profit": 71.686224, "Profit_Margin": 12.18252526063854, "Avg_Ticket_Price": 267.96491199999997, "Avg_Profit_Per_Ticket": 32.20557866666667, "Top_Events": [{"Event": "Dallas Mavericks vs. Houston Rockets", "Profit": 4088.71, "PO #": 26}, {"Event": "Dallas Stars vs. Los Angeles Kings", "Profit": 2518.61, "PO #": 46}, {"Event": "Dallas Mavericks vs. Detroit Pistons", "Profit": 1911.27, "PO #": 14}, {"Event": "Dallas Stars vs. Colorado Avalanche", "Profit": 1885.22, "PO #": 23}, {"Event": "Dallas Stars vs. Buffalo Sabres", "Profit": 1812.04, "PO #": 31}], "Monthly_Trend": {"2025-01": 1121.04, "2025-02": 414.97, "2025-03": 433.08000000000004, "2025-04": 878.69, "2025-05": 2461.37, "2025-06": 987.96, "2025-07": 259.57, "2025-08": 410.68, "2025-09": 1384.32, "2025-10": 7662.45, "2025-11": 8664.23, "2025-12": 20125.53}, "Day_of_Week": {"Friday": 7225.01, "Monday": 6734.12, "Saturday": 7757.01, "Sunday": 4895.17, "Thursday": 6116.66, "Tuesday": 4430.13, "Wednesday": 7645.79}}, {"Venue": "Madison Square Garden", "Total_Transactions": 600, "Total_Profit": 66833.74, "Total_Revenue": 679293.63, "Avg_Profit": 111.38956666666668, "Profit_Margin": 9.838711427339604, "Avg_Ticket_Price": 545.4056166666667, "Avg_Profit_Per_Ticket": 50.10144680555556, "Top_Events": [{"Event": "New York Knicks vs. Indiana Pacers", "Profit": 12295.0, "PO #": 14}, {"Event": "Lady Gaga", "Profit": 5604.67, "PO #": 16}, {"Event": "New York Knicks vs. Boston Celtics", "Profit": 4850.13, "PO #": 19}, {"Event": "New York Knicks vs. Philadelphia 76ers", "Profit": 3354.15, "PO #": 19}, {"Event": "New York Knicks vs. Cleveland Cavaliers", "Profit": 2923.23, "PO #": 17}], "Monthly_Trend": {"2025-01": 1319.41, "2025-02": 714.36, "2025-03": 561.36, "2025-04": 1963.46, "2025-05": 16598.21, "2025-06": 381.82, "2025-07": 336.92, "2025-08": 6249.89, "2025-09": 1857.61, "2025-10": 7664.24, "2025-11": 9116.83, "2025-12": 20069.63}, "Day_of_Week": {"Friday": 7521.38, "Monday": 13066.36, "Saturday": 7437.16, "Sunday": 7374.46, "Thursday": 5812.11, "Tuesday": 17272.09, "Wednesday": 8350.18}}, {"Venue": "Chase Center", "Total_Transactions": 470, "Total_Profit": 35430.59, "Total_Revenue": 330708.44, "Avg_Profit": 75.38423404255319, "Profit_Margin": 10.713542720590983, "Avg_Ticket_Price": 334.8686595744681, "Avg_Profit_Per_Ticket": 35.233772922998995, "Top_Events": [{"Event": "Golden State Warriors vs. Oklahoma City Thunder", "Profit": 7459.54, "PO #": 34}, {"Event": "Golden State Warriors vs. Houston Rockets", "Profit": 2196.55, "PO #": 12}, {"Event": "Golden State Warriors vs. Orlando Magic", "Profit": 1904.32, "PO #": 18}, {"Event": "Golden State Warriors vs. Boston Celtics", "Profit": 1759.06, "PO #": 4}, {"Event": "Golden State Warriors vs. Phoenix Suns", "Profit": 1703.0, "PO #": 43}], "Monthly_Trend": {"2025-01": 587.4, "2025-02": 384.88, "2025-03": 428.56, "2025-04": 368.19, "2025-05": 320.86, "2025-06": 592.8000000000001, "2025-07": 715.63, "2025-08": 2394.35, "2025-09": 1801.39, "2025-10": 5259.02, "2025-11": 9102.42, "2025-12": 13475.09}, "Day_of_Week": {"Friday": 5358.85, "Monday": 4203.22, "Saturday": 5604.96, "Sunday": 4101.3, "Thursday": 5690.42, "Tuesday": 7131.0, "Wednesday": 3340.84}}, {"Venue": "TD Garden", "Total_Transactions": 427, "Total_Profit": 28263.05, "Total_Revenue": 300035.65, "Avg_Profit": 66.18981264637002, "Profit_Margin": 9.419897268874548, "Avg_Ticket_Price": 331.97653395784545, "Avg_Profit_Per_Ticket": 28.792736143637786, "Top_Events": [{"Event": "Boston Celtics vs. New York Knicks", "Profit": 2643.7200000000003, "PO #": 29}, {"Event": "Boston Celtics vs. Toronto Raptors", "Profit": 1642.5800000000002, "PO #": 23}, {"Event": "Boston Celtics vs. Denver Nuggets", "Profit": 1570.86, "PO #": 8}, {"Event": "Boston Celtics vs. Indiana Pacers", "Profit": 1431.56, "PO #": 21}, {"Event": "Boston Celtics vs. Los Angeles Lakers", "Profit": 1412.97, "PO #": 13}], "Monthly_Trend": {"2025-01": 166.28, "2025-02": 1545.73, "2025-03": 380.92, "2025-04": 1401.74, "2025-05": 2381.46, "2025-06": 98.51, "2025-07": 396.13, "2025-08": 612.68, "2025-09": 1233.42, "2025-10": 5708.33, "2025-11": 4749.36, "2025-12": 9588.49}, "Day_of_Week": {"Friday": 4799.96, "Monday": 4342.45, "Saturday": 3011.11, "Sunday": 4386.52, "Thursday": 3103.68, "Tuesday": 5977.1900000000005, "Wednesday": 2642.14}}, {"Venue": "Xfinity Mobile Arena", "Total_Transactions": 302, "Total_Profit": 15062.689999999999, "Total_Revenue": 141572.55, "Avg_Profit": 49.87645695364238, "Profit_Margin": 10.639555478798679, "Avg_Ticket_Price": 224.2303311258278, "Avg_Profit_Per_Ticket": 22.71777041942605, "Top_Events": [{"Event": "Philadelphia 76ers vs. Golden State Warriors", "Profit": 1755.0200000000002, "PO #": 4}, {"Event": "Philadelphia 76ers vs. Los Angeles Lakers", "Profit": 1513.1699999999998, "PO #": 5}, {"Event": "Philadelphia Flyers vs. New Jersey Devils", "Profit": 799.26, "PO #": 14}, {"Event": "Eric Clapton w/ The Wallflowers", "Profit": 774.14, "PO #": 3}, {"Event": "Philadelphia 76ers vs. Orlando Magic", "Profit": 590.1700000000001, "PO #": 10}], "Monthly_Trend": {"2025-01": 847.54, "2025-02": 597.24, "2025-03": 969.66, "2025-04": 368.78, "2025-05": 215.19, "2025-07": 265.74, "2025-08": 415.71, "2025-09": 1015.4, "2025-10": 2374.69, "2025-11": 4124.650000000001, "2025-12": 3868.09}, "Day_of_Week": {"Friday": 1988.6299999999999, "Monday": 2432.71, "Saturday": 1739.45, "Sunday": 1348.17, "Thursday": 4636.2300000000005, "Tuesday": 1657.65, "Wednesday": 1259.85}}, {"Venue": "Little Caesars Arena", "Total_Transactions": 276, "Total_Profit": 16764.4, "Total_Revenue": 155504.92, "Avg_Profit": 60.740579710144935, "Profit_Margin": 10.780623532683082, "Avg_Ticket_Price": 241.52507246376817, "Avg_Profit_Per_Ticket": 24.320996980676327, "Top_Events": [{"Event": "Detroit Red Wings vs. Nashville Predators", "Profit": 1579.24, "PO #": 14}, {"Event": "Detroit Red Wings vs. Toronto Maple Leafs", "Profit": 1524.8200000000002, "PO #": 19}, {"Event": "Detroit Pistons vs. Orlando Magic", "Profit": 1369.3799999999999, "PO #": 8}, {"Event": "Detroit Red Wings vs. Washington Capitals", "Profit": 1101.8200000000002, "PO #": 13}, {"Event": "Detroit Pistons vs. Atlanta Hawks", "Profit": 1033.27, "PO #": 12}], "Monthly_Trend": {"2025-01": 695.73, "2025-02": 388.78000000000003, "2025-03": 330.24, "2025-04": 503.77, "2025-06": 117.93, "2025-07": 245.3, "2025-08": 108.81, "2025-09": 349.25, "2025-10": 2486.39, "2025-11": 4586.0, "2025-12": 6952.2}, "Day_of_Week": {"Friday": 2132.94, "Monday": 1574.45, "Saturday": 2148.21, "Sunday": 843.62, "Thursday": 2252.84, "Tuesday": 4695.51, "Wednesday": 3116.83}}, {"Venue": "Capital One Arena", "Total_Transactions": 263, "Total_Profit": 18767.44, "Total_Revenue": 158155.72, "Avg_Profit": 71.35908745247148, "Profit_Margin": 11.866431388001647, "Avg_Ticket_Price": 297.4185931558935, "Avg_Profit_Per_Ticket": 35.65708808618505, "Top_Events": [{"Event": "Washington Capitals vs. New York Rangers", "Profit": 2058.89, "PO #": 24}, {"Event": "Washington Wizards vs. Los Angeles Lakers", "Profit": 1343.49, "PO #": 8}, {"Event": "Washington Capitals vs. Toronto Maple Leafs", "Profit": 1053.13, "PO #": 12}, {"Event": "Washington Wizards vs. Atlanta Hawks", "Profit": 799.8, "PO #": 13}, {"Event": "Washington Capitals vs. Carolina Hurricanes", "Profit": 787.53, "PO #": 9}], "Monthly_Trend": {"2025-01": 2479.46, "2025-02": 1723.22, "2025-03": 521.38, "2025-04": 341.71999999999997, "2025-05": 134.52, "2025-08": 173.59, "2025-09": 74.53999999999999, "2025-10": 2977.5, "2025-11": 3596.77, "2025-12": 6744.74}, "Day_of_Week": {"Friday": 2320.26, "Monday": 3088.8, "Saturday": 2509.5, "Sunday": 2666.91, "Thursday": 2941.89, "Tuesday": 3210.24, "Wednesday": 2029.84}}, {"Venue": "Moda Center", "Total_Transactions": 260, "Total_Profit": 6827.17, "Total_Revenue": 66190.51999999999, "Avg_Profit": 26.258346153846155, "Profit_Margin": 10.314422669590753, "Avg_Ticket_Price": 139.03642307692309, "Avg_Profit_Per_Ticket": 14.27461858974359, "Top_Events": [{"Event": "Portland Trail Blazers vs. Boston Celtics", "Profit": 802.8399999999999, "PO #": 9}, {"Event": "Portland Trail Blazers vs. Los Angeles Lakers", "Profit": 636.72, "PO #": 14}, {"Event": "Portland Trail Blazers", "Profit": 559.0600000000001, "PO #": 16}, {"Event": "Portland Trail Blazers vs. Milwaukee Bucks", "Profit": 394.98, "PO #": 4}, {"Event": "Portland Trail Blazers vs. Denver Nuggets", "Profit": 367.45000000000005, "PO #": 10}], "Monthly_Trend": {"2025-01": 882.02, "2025-02": 641.79, "2025-03": 1051.59, "2025-04": 200.49, "2025-05": 47.61, "2025-06": 26.41, "2025-07": -5.5699999999999905, "2025-08": -13.57, "2025-09": 341.56, "2025-10": 1351.42, "2025-11": 570.8199999999999, "2025-12": 1732.6000000000001}, "Day_of_Week": {"Friday": 1153.22, "Monday": 604.79, "Saturday": 1664.77, "Sunday": 875.16, "Thursday": 1141.72, "Tuesday": 715.4, "Wednesday": 672.11}}, {"Venue": "Grand Casino Arena", "Total_Transactions": 255, "Total_Profit": 7775.8099999999995, "Total_Revenue": 71695.26999999999, "Avg_Profit": 30.493372549019607, "Profit_Margin": 10.845638770870101, "Avg_Ticket_Price": 125.472431372549, "Avg_Profit_Per_Ticket": 13.416024183006536, "Top_Events": [{"Event": "Minnesota Wild vs. Colorado Avalanche", "Profit": 861.17, "PO #": 28}, {"Event": "Minnesota Wild vs. Edmonton Oilers", "Profit": 647.36, "PO #": 21}, {"Event": "Minnesota Wild vs. Washington Capitals", "Profit": 579.13, "PO #": 10}, {"Event": "Minnesota Wild vs. Nashville Predators", "Profit": 445.13, "PO #": 14}, {"Event": "Minnesota Wild vs. Boston Bruins", "Profit": 404.05, "PO #": 13}], "Monthly_Trend": {"2025-01": 324.73, "2025-02": 337.34000000000003, "2025-03": 243.78, "2025-04": 279.87, "2025-07": 6.56, "2025-08": 72.54, "2025-09": 690.13, "2025-10": 1133.72, "2025-11": 1457.85, "2025-12": 3229.29}, "Day_of_Week": {"Friday": 1190.18, "Monday": 1261.95, "Saturday": 1631.27, "Sunday": 1344.25, "Thursday": 828.84, "Tuesday": 943.64, "Wednesday": 575.6800000000001}}, {"Venue": "Ball Arena", "Total_Transactions": 244, "Total_Profit": 16007.080000000002, "Total_Revenue": 132001.32, "Avg_Profit": 65.6027868852459, "Profit_Margin": 12.126454493030828, "Avg_Ticket_Price": 253.6077868852459, "Avg_Profit_Per_Ticket": 29.585770719489982, "Top_Events": [{"Event": "Denver Nuggets vs. Los Angeles Lakers", "Profit": 3207.6200000000003, "PO #": 4}, {"Event": "Denver Nuggets vs. Minnesota Timberwolves", "Profit": 1397.92, "PO #": 15}, {"Event": "Denver Nuggets vs. Phoenix Suns", "Profit": 797.79, "PO #": 4}, {"Event": "Colorado Avalanche vs. Montreal Canadiens", "Profit": 748.3, "PO #": 8}, {"Event": "Colorado Avalanche vs. Dallas Stars", "Profit": 741.3800000000001, "PO #": 8}], "Monthly_Trend": {"2025-01": 274.38, "2025-02": 321.44, "2025-03": 3873.82, "2025-04": 35.69, "2025-06": 554.87, "2025-07": 26.270000000000003, "2025-08": -87.39999999999998, "2025-09": 637.37, "2025-10": 1215.7, "2025-11": 2434.37, "2025-12": 6720.57}, "Day_of_Week": {"Friday": 4069.48, "Monday": 2650.26, "Saturday": 1629.71, "Sunday": 1348.16, "Thursday": 1660.3799999999999, "Tuesday": 1913.23, "Wednesday": 2735.86}}], "event_details": [{"Event": "FIFA Club World Cup Soccer", "Total_Transactions": 173, "Total_Profit": 4589.16, "Total_Revenue": 52301.69, "Avg_Profit": 26.52693641618497, "Profit_Margin": 8.774400980159532, "Avg_Ticket_Price": 173.08618497109828, "Total_Tickets": 293, "Venues": [{"Venue": "MetLife Stadium", "Profit": 1426.6, "PO #": 33}, {"Venue": "Rose Bowl", "Profit": 944.86, "PO #": 41}, {"Venue": "Mercedes-Benz Stadium", "Profit": 573.6700000000001, "PO #": 18}, {"Venue": "Lumen Field", "Profit": 457.14000000000004, "PO #": 21}, {"Venue": "Lincoln Financial Field", "Profit": 453.02, "PO #": 28}], "Price_Distribution": {"<$100": {"Profit": 700.09, "PO #": 70}, "$100-200": {"Profit": 1380.69, "PO #": 66}, "$200-300": {"Profit": 512.07, "PO #": 20}, "$300-500": {"Profit": 756.52, "PO #": 10}, "$500+": {"Profit": 1239.79, "PO #": 7}}}, {"Event": "NCAA College World Series", "Total_Transactions": 114, "Total_Profit": 4360.929999999999, "Total_Revenue": 52897.90000000001, "Avg_Profit": 38.25377192982456, "Profit_Margin": 8.244051276137613, "Avg_Ticket_Price": 187.10508771929827, "Total_Tickets": 272, "Venues": [{"Venue": "Charles Schwab Field Omaha", "Profit": 4360.93, "PO #": 114}], "Price_Distribution": {"<$100": {"Profit": 297.49, "PO #": 53}, "$100-200": {"Profit": 1220.13, "PO #": 32}, "$200-300": {"Profit": 327.52, "PO #": 7}, "$300-500": {"Profit": 899.52, "PO #": 12}, "$500+": {"Profit": 1616.27, "PO #": 10}}}, {"Event": "The Weeknd w/ Playboi Carti", "Total_Transactions": 90, "Total_Profit": 5207.28, "Total_Revenue": 41564.20999999999, "Avg_Profit": 57.858666666666664, "Profit_Margin": 12.528278535788365, "Avg_Ticket_Price": 298.5948888888889, "Total_Tickets": 126, "Venues": [{"Venue": "Hard Rock Stadium", "Profit": 1290.3300000000002, "PO #": 11}, {"Venue": "Camping World Stadium", "Profit": 1033.43, "PO #": 7}, {"Venue": "NRG Stadium", "Profit": 553.03, "PO #": 5}, {"Venue": "Mercedes-Benz Stadium", "Profit": 548.0, "PO #": 6}, {"Venue": "Allegiant Stadium", "Profit": 305.79, "PO #": 3}], "Price_Distribution": {"<$100": {"Profit": 149.9, "PO #": 23}, "$100-200": {"Profit": 569.63, "PO #": 27}, "$200-300": {"Profit": 500.89, "PO #": 15}, "$300-500": {"Profit": 956.11, "PO #": 10}, "$500+": {"Profit": 3030.75, "PO #": 15}}}, {"Event": "Alabama Crimson Tide Football vs. Eastern Illinois Panthers Football", "Total_Transactions": 87, "Total_Profit": 916.8699999999999, "Total_Revenue": 7676.389999999999, "Avg_Profit": 10.538735632183906, "Profit_Margin": 11.944025772531099, "Avg_Ticket_Price": 44.84379310344828, "Total_Tickets": 153, "Venues": [{"Venue": "Saban Field at Bryant-Denny Stadium", "Profit": 916.87, "PO #": 87}], "Price_Distribution": {"<$100": {"Profit": 234.92999999999995, "PO #": 82}, "$100-200": {"Profit": 362.37, "PO #": 3}, "$200-300": {"Profit": 0.0, "PO #": 0}, "$300-500": {"Profit": 319.57000000000005, "PO #": 2}, "$500+": {"Profit": 0.0, "PO #": 0}}}, {"Event": "Penn State Nittany Lions Football vs. Indiana Hoosiers Football", "Total_Transactions": 69, "Total_Profit": 1598.8500000000001, "Total_Revenue": 19468.68, "Avg_Profit": 23.171739130434784, "Profit_Margin": 8.212421181097024, "Avg_Ticket_Price": 108.2017391304348, "Total_Tickets": 168, "Venues": [{"Venue": "Beaver Stadium", "Profit": 1598.8500000000001, "PO #": 69}], "Price_Distribution": {"<$100": {"Profit": 330.78, "PO #": 39}, "$100-200": {"Profit": 716.91, "PO #": 22}, "$200-300": {"Profit": 412.34000000000003, "PO #": 6}, "$300-500": {"Profit": 55.93, "PO #": 1}, "$500+": {"Profit": 82.89, "PO #": 1}}}, {"Event": "NASCAR Cup Series", "Total_Transactions": 68, "Total_Profit": 2205.3399999999997, "Total_Revenue": 21321.269999999997, "Avg_Profit": 32.43147058823529, "Profit_Margin": 10.34338010822057, "Avg_Ticket_Price": 147.5826470588235, "Total_Tickets": 140, "Venues": [{"Venue": "Talladega Superspeedway", "Profit": 548.52, "PO #": 18}, {"Venue": "Phoenix Raceway", "Profit": 441.56, "PO #": 13}, {"Venue": "Richmond Raceway", "Profit": 340.67, "PO #": 9}, {"Venue": "Michigan International Speedway", "Profit": 219.43, "PO #": 4}, {"Venue": "Daytona International Speedway", "Profit": 161.29, "PO #": 2}], "Price_Distribution": {"<$100": {"Profit": 305.86, "PO #": 17}, "$100-200": {"Profit": 909.63, "PO #": 35}, "$200-300": {"Profit": 749.83, "PO #": 11}, "$300-500": {"Profit": 231.75, "PO #": 2}, "$500+": {"Profit": 153.75, "PO #": 1}}}, {"Event": "WWE - World Wrestling Entertainment", "Total_Transactions": 64, "Total_Profit": 3482.3500000000004, "Total_Revenue": 35377.17, "Avg_Profit": 54.411718750000006, "Profit_Margin": 9.843495112808629, "Avg_Ticket_Price": 345.364375, "Total_Tickets": 105, "Venues": [{"Venue": "PETCO Park", "Profit": 1587.8, "PO #": 20}, {"Venue": "Yuengling Center", "Profit": 369.28999999999996, "PO #": 2}, {"Venue": "Capital One Arena", "Profit": 285.51, "PO #": 2}, {"Venue": "Rogers Centre", "Profit": 229.25, "PO #": 2}, {"Venue": "Madison Square Garden", "Profit": 160.31, "PO #": 6}], "Price_Distribution": {"<$100": {"Profit": 197.92000000000002, "PO #": 13}, "$100-200": {"Profit": 209.65, "PO #": 12}, "$200-300": {"Profit": 178.84000000000003, "PO #": 8}, "$300-500": {"Profit": 1039.23, "PO #": 16}, "$500+": {"Profit": 1856.71, "PO #": 15}}}, {"Event": "Chris Brown w/ Summer Walker", "Total_Transactions": 61, "Total_Profit": 3770.459999999998, "Total_Revenue": 51654.409999999996, "Avg_Profit": 61.81081967213112, "Profit_Margin": 7.299396121260505, "Avg_Ticket_Price": 508.3868852459017, "Total_Tickets": 92, "Venues": [{"Venue": "SoFi Stadium", "Profit": 1358.37, "PO #": 8}, {"Venue": "Ford Field", "Profit": 906.02, "PO #": 5}, {"Venue": "LoanDepot Park", "Profit": 710.9, "PO #": 5}, {"Venue": "MetLife Stadium", "Profit": 645.43, "PO #": 6}, {"Venue": "Nationals Park", "Profit": 524.8, "PO #": 4}], "Price_Distribution": {"<$100": {"Profit": -49.93000000000001, "PO #": 2}, "$100-200": {"Profit": 279.83, "PO #": 15}, "$200-300": {"Profit": 320.65, "PO #": 7}, "$300-500": {"Profit": 1046.69, "PO #": 16}, "$500+": {"Profit": 4972.85, "PO #": 20}}}, {"Event": "Sugar Bowl", "Total_Transactions": 55, "Total_Profit": 7430.65, "Total_Revenue": 72211.24000000002, "Avg_Profit": 135.10272727272726, "Profit_Margin": 10.290157044803548, "Avg_Ticket_Price": 501.038909090909, "Total_Tickets": 139, "Venues": [{"Venue": "Caesars Superdome", "Profit": 7430.65, "PO #": 55}], "Price_Distribution": {"<$100": {"Profit": 0.0, "PO #": 0}, "$100-200": {"Profit": 66.19999999999999, "PO #": 4}, "$200-300": {"Profit": 378.09, "PO #": 14}, "$300-500": {"Profit": 2709.39, "PO #": 19}, "$500+": {"Profit": 4276.97, "PO #": 18}}}, {"Event": "Penn State Nittany Lions Football vs. Nebraska Cornhuskers Football", "Total_Transactions": 54, "Total_Profit": 1245.6499999999999, "Total_Revenue": 10802.650000000001, "Avg_Profit": 23.06759259259259, "Profit_Margin": 11.530966938667824, "Avg_Ticket_Price": 74.56296296296297, "Total_Tickets": 132, "Venues": [{"Venue": "Beaver Stadium", "Profit": 1245.65, "PO #": 54}], "Price_Distribution": {"<$100": {"Profit": 629.12, "PO #": 41}, "$100-200": {"Profit": 536.04, "PO #": 12}, "$200-300": {"Profit": 80.49, "PO #": 1}, "$300-500": {"Profit": 0.0, "PO #": 0}, "$500+": {"Profit": 0.0, "PO #": 0}}}], "venue_comparison": [{"Venue": "American Airlines Center - TX", "Transactions": 625, "Profit": 44803.89, "Revenue": 367771.77999999997, "Margin": 12.18252526063854, "Avg_Price": 267.96491199999997, "Profitable_Rate": 97.11999999999999}, {"Venue": "Madison Square Garden", "Transactions": 600, "Profit": 66833.74, "Revenue": 679293.63, "Margin": 9.838711427339604, "Avg_Price": 545.4056166666667, "Profitable_Rate": 95.66666666666667}, {"Venue": "Chase Center", "Transactions": 470, "Profit": 35430.59, "Revenue": 330708.44, "Margin": 10.713542720590983, "Avg_Price": 334.8686595744681, "Profitable_Rate": 95.53191489361701}, {"Venue": "TD Garden", "Transactions": 427, "Profit": 28263.05, "Revenue": 300035.65, "Margin": 9.419897268874548, "Avg_Price": 331.97653395784545, "Profitable_Rate": 94.14519906323186}, {"Venue": "Xfinity Mobile Arena", "Transactions": 302, "Profit": 15062.689999999999, "Revenue": 141572.55, "Margin": 10.639555478798679, "Avg_Price": 224.2303311258278, "Profitable_Rate": 95.03311258278146}, {"Venue": "Little Caesars Arena", "Transactions": 276, "Profit": 16764.4, "Revenue": 155504.92, "Margin": 10.780623532683082, "Avg_Price": 241.52507246376817, "Profitable_Rate": 96.73913043478261}, {"Venue": "Capital One Arena", "Transactions": 263, "Profit": 18767.44, "Revenue": 158155.72, "Margin": 11.866431388001647, "Avg_Price": 297.4185931558935, "Profitable_Rate": 97.71863117870723}, {"Venue": "Moda Center", "Transactions": 260, "Profit": 6827.17, "Revenue": 66190.51999999999, "Margin": 10.314422669590753, "Avg_Price": 139.03642307692309, "Profitable_Rate": 96.15384615384616}, {"Venue": "Grand Casino Arena", "Transactions": 255, "Profit": 7775.8099999999995, "Revenue": 71695.26999999999, "Margin": 10.845638770870101, "Avg_Price": 125.472431372549, "Profitable_Rate": 94.11764705882352}, {"Venue": "Ball Arena", "Transactions": 244, "Profit": 16007.080000000002, "Revenue": 132001.32, "Margin": 12.126454493030828, "Avg_Price": 253.6077868852459, "Profitable_Rate": 95.49180327868852}], "event_comparison": [{"Event": "FIFA Club World Cup Soccer", "Transactions": 173, "Profit": 4589.16, "Revenue": 52301.69, "Margin": 8.774400980159532, "Avg_Price": 173.08618497109828, "Total_Tickets": 293}, {"Event": "NCAA College World Series", "Transactions": 114, "Profit": 4360.929999999999, "Revenue": 52897.90000000001, "Margin": 8.244051276137613, "Avg_Price": 187.10508771929827, "Total_Tickets": 272}, {"Event": "The Weeknd w/ Playboi Carti", "Transactions": 90, "Profit": 5207.28, "Revenue": 41564.20999999999, "Margin": 12.528278535788365, "Avg_Price": 298.5948888888889, "Total_Tickets": 126}, {"Event": "Alabama Crimson Tide Football vs. Eastern Illinois Panthers Football", "Transactions": 87, "Profit": 916.8699999999999, "Revenue": 7676.389999999999, "Margin": 11.944025772531099, "Avg_Price": 44.84379310344828, "Total_Tickets": 153}, {"Event": "Penn State Nittany Lions Football vs. Indiana Hoosiers Football", "Transactions": 69, "Profit": 1598.8500000000001, "Revenue": 19468.68, "Margin": 8.212421181097024, "Avg_Price": 108.2017391304348, "Total_Tickets": 168}, {"Event": "NASCAR Cup Series", "Transactions": 68, "Profit": 2205.3399999999997, "Revenue": 21321.269999999997, "Margin": 10.34338010822057, "Avg_Price": 147.5826470588235, "Total_Tickets": 140}, {"Event": "WWE - World Wrestling Entertainment", "Transactions": 64, "Profit": 3482.3500000000004, "Revenue": 35377.17, "Margin": 9.843495112808629, "Avg_Price": 345.364375, "Total_Tickets": 105}, {"Event": "Chris Brown w/ Summer Walker", "Transactions": 61, "Profit": 3770.459999999998, "Revenue": 51654.409999999996, "Margin": 7.299396121260505, "Avg_Price": 508.3868852459017, "Total_Tickets": 92}, {"Event": "Sugar Bowl", "Transactions": 55, "Profit": 7430.65, "Revenue": 72211.24000000002, "Margin": 10.290157044803548, "Avg_Price": 501.038909090909, "Total_Tickets": 139}, {"Event": "Penn State Nittany Lions Football vs. Nebraska Cornhuskers Football", "Transactions": 54, "Profit": 1245.6499999999999, "Revenue": 10802.650000000001, "Margin": 11.530966938667824, "Avg_Price": 74.56296296296297, "Total_Tickets": 132}], "venue_event_matrix": [{"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Indiana Pacers", "Transactions": 14, "Profit": 12295.0, "Avg_Profit": 878.2142857142857, "Margin": 8.503066152402331}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Oklahoma City Thunder", "Transactions": 34, "Profit": 7459.539999999999, "Avg_Profit": 219.39823529411763, "Margin": 13.22274935282527}, {"Venue": "Madison Square Garden", "Event": "Lady Gaga", "Transactions": 16, "Profit": 5604.669999999999, "Avg_Profit": 350.29187499999995, "Margin": 11.27338182748558}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Boston Celtics", "Transactions": 19, "Profit": 4850.13, "Avg_Profit": 255.27, "Margin": 8.721423269356364}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Mavericks vs. Houston Rockets", "Transactions": 26, "Profit": 4088.71, "Avg_Profit": 157.2580769230769, "Margin": 13.268441326224313}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Philadelphia 76ers", "Transactions": 19, "Profit": 3354.1499999999996, "Avg_Profit": 176.53421052631577, "Margin": 9.486925655131449}, {"Venue": "Ball Arena", "Event": "Denver Nuggets vs. Los Angeles Lakers", "Transactions": 4, "Profit": 3207.62, "Avg_Profit": 801.905, "Margin": 21.840720883646252}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Cleveland Cavaliers", "Transactions": 17, "Profit": 2923.23, "Avg_Profit": 171.95470588235295, "Margin": 9.596417531797325}, {"Venue": "TD Garden", "Event": "Boston Celtics vs. New York Knicks", "Transactions": 29, "Profit": 2643.7199999999993, "Avg_Profit": 91.16275862068963, "Margin": 7.936529856100635}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Stars vs. Los Angeles Kings", "Transactions": 46, "Profit": 2518.61, "Avg_Profit": 54.75239130434783, "Margin": 13.216817711913773}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Charlotte Hornets", "Transactions": 32, "Profit": 2384.66, "Avg_Profit": 74.520625, "Margin": 10.272016802849523}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Houston Rockets", "Transactions": 12, "Profit": 2196.55, "Avg_Profit": 183.04583333333335, "Margin": 10.836805324295058}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Orlando Magic", "Transactions": 20, "Profit": 2173.4, "Avg_Profit": 108.67, "Margin": 9.57476568609095}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Miami HEAT", "Transactions": 15, "Profit": 2142.3699999999994, "Avg_Profit": 142.82466666666662, "Margin": 11.911372896132082}, {"Venue": "Capital One Arena", "Event": "Washington Capitals vs. New York Rangers", "Transactions": 24, "Profit": 2058.89, "Avg_Profit": 85.78708333333333, "Margin": 11.336295206511641}, {"Venue": "Madison Square Garden", "Event": "New York Knicks vs. Detroit Pistons", "Transactions": 9, "Profit": 2053.24, "Avg_Profit": 228.13777777777776, "Margin": 8.286681634493103}, {"Venue": "Madison Square Garden", "Event": "Tate McRae w/ Alessi Rose", "Transactions": 5, "Profit": 1939.51, "Avg_Profit": 387.902, "Margin": 12.202473827259915}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Mavericks vs. Detroit Pistons", "Transactions": 14, "Profit": 1911.2699999999998, "Avg_Profit": 136.5192857142857, "Margin": 13.831801267048489}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Orlando Magic", "Transactions": 18, "Profit": 1904.32, "Avg_Profit": 105.79555555555555, "Margin": 10.295057364756815}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Stars vs. Colorado Avalanche", "Transactions": 23, "Profit": 1885.2200000000003, "Avg_Profit": 81.96608695652175, "Margin": 12.158238583230684}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Stars vs. Buffalo Sabres", "Transactions": 31, "Profit": 1812.0400000000002, "Avg_Profit": 58.45290322580646, "Margin": 10.166657689683651}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Mavericks vs. Los Angeles Lakers", "Transactions": 5, "Profit": 1774.48, "Avg_Profit": 354.896, "Margin": 7.884356141425039}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Boston Celtics", "Transactions": 4, "Profit": 1759.06, "Avg_Profit": 439.765, "Margin": 9.453926712263243}, {"Venue": "Xfinity Mobile Arena", "Event": "Philadelphia 76ers vs. Golden State Warriors", "Transactions": 4, "Profit": 1755.0200000000002, "Avg_Profit": 438.75500000000005, "Margin": 9.444924608295727}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Stars vs. Pittsburgh Penguins", "Transactions": 22, "Profit": 1712.4099999999996, "Avg_Profit": 77.83681818181816, "Margin": 12.39507963669107}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Phoenix Suns", "Transactions": 43, "Profit": 1702.9999999999998, "Avg_Profit": 39.604651162790695, "Margin": 9.614684327274144}, {"Venue": "American Airlines Center - TX", "Event": "Dallas Stars vs. Florida Panthers", "Transactions": 30, "Profit": 1660.7300000000002, "Avg_Profit": 55.357666666666674, "Margin": 12.492656268218287}, {"Venue": "Chase Center", "Event": "Golden State Warriors vs. Minnesota Timberwolves", "Transactions": 29, "Profit": 1652.7800000000002, "Avg_Profit": 56.99241379310345, "Margin": 10.365194399917723}, {"Venue": "TD Garden", "Event": "Boston Celtics vs. Toronto Raptors", "Transactions": 23, "Profit": 1642.5800000000004, "Avg_Profit": 71.41652173913045, "Margin": 10.296254414480375}, {"Venue": "Little Caesars Arena", "Event": "Detroit Red Wings vs. Nashville Predators", "Transactions": 14, "Profit": 1579.24, "Avg_Profit": 112.80285714285715, "Margin": 11.245432904733116}]};
        
        // Format functions
        const formatCurrency = (val) => {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(val);
        };
        
        const formatNumber = (val) => {
            return new Intl.NumberFormat('en-US').format(val);
        };
        
        // Update KPIs
        const venuesSummary = data.top_venues_summary;
        const eventsSummary = data.top_events_summary;
        
        document.getElementById('venuesTransactions').textContent = formatNumber(venuesSummary.total_transactions);
        document.getElementById('venuesProfit').textContent = formatCurrency(venuesSummary.total_profit);
        document.getElementById('venuesMargin').textContent = venuesSummary.profit_margin.toFixed(2) + '% margin';
        document.getElementById('venuesAvgProfit').textContent = formatCurrency(venuesSummary.avg_profit);
        document.getElementById('venuesProfitableRate').textContent = venuesSummary.profitable_pct.toFixed(1) + '% profitable';
        
        document.getElementById('eventsTransactions').textContent = formatNumber(eventsSummary.total_transactions);
        document.getElementById('eventsProfit').textContent = formatCurrency(eventsSummary.total_profit);
        document.getElementById('eventsMargin').textContent = eventsSummary.profit_margin.toFixed(2) + '% margin';
        document.getElementById('eventsAvgProfit').textContent = formatCurrency(eventsSummary.avg_profit);
        document.getElementById('eventsProfitableRate').textContent = eventsSummary.profitable_pct.toFixed(1) + '% profitable';
        
        // Chart colors
        const colors = {
            primary: 'rgba(102, 126, 234, 0.8)',
            secondary: 'rgba(118, 75, 162, 0.8)',
            success: 'rgba(40, 167, 69, 0.8)',
            danger: 'rgba(220, 53, 69, 0.8)',
            warning: 'rgba(255, 193, 7, 0.8)',
            info: 'rgba(23, 162, 184, 0.8)'
        };
        
        // Generate color array
        const generateColors = (count) => {
            const baseColors = [colors.primary, colors.secondary, colors.success, colors.warning, colors.info, colors.danger];
            return Array(count).fill(0).map((_, i) => baseColors[i % baseColors.length]);
        };
        
        // Overview Charts
        new Chart(document.getElementById('venuesOverviewChart'), {
            type: 'bar',
            data: {
                labels: data.venue_comparison.map(v => v.Venue.substring(0, 25)),
                datasets: [{
                    label: 'Transactions',
                    data: data.venue_comparison.map(v => v.Transactions),
                    backgroundColor: colors.primary
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => {
                                const v = data.venue_comparison[context.dataIndex];
                                return [
                                    'Transactions: ' + formatNumber(v.Transactions),
                                    'Profit: ' + formatCurrency(v.Profit),
                                    'Margin: ' + v.Margin.toFixed(1) + '%'
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Number of Transactions' }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('eventsOverviewChart'), {
            type: 'bar',
            data: {
                labels: data.event_comparison.map(e => e.Event.substring(0, 25)),
                datasets: [{
                    label: 'Transactions',
                    data: data.event_comparison.map(e => e.Transactions),
                    backgroundColor: colors.secondary
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => {
                                const e = data.event_comparison[context.dataIndex];
                                return [
                                    'Transactions: ' + formatNumber(e.Transactions),
                                    'Profit: ' + formatCurrency(e.Profit),
                                    'Tickets: ' + formatNumber(e.Total_Tickets)
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Number of Transactions' }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        // Venue Charts
        new Chart(document.getElementById('venueProfitChart'), {
            type: 'bar',
            data: {
                labels: data.venue_comparison.map(v => v.Venue.substring(0, 30)),
                datasets: [{
                    label: 'Total Profit',
                    data: data.venue_comparison.map(v => v.Profit),
                    backgroundColor: colors.success
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        ticks: {
                            callback: (value) => '$' + (value/1000).toFixed(0) + 'K'
                        }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('venueMarginChart'), {
            type: 'bar',
            data: {
                labels: data.venue_comparison.map(v => v.Venue.substring(0, 25)),
                datasets: [{
                    label: 'Profit Margin %',
                    data: data.venue_comparison.map(v => v.Margin),
                    backgroundColor: colors.warning
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: (value) => value.toFixed(1) + '%'
                        }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('venuePriceChart'), {
            type: 'bar',
            data: {
                labels: data.venue_comparison.map(v => v.Venue.substring(0, 25)),
                datasets: [{
                    label: 'Avg Ticket Price',
                    data: data.venue_comparison.map(v => v.Avg_Price),
                    backgroundColor: colors.info
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: (value) => '$' + value
                        }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        // Event Charts
        new Chart(document.getElementById('eventProfitChart'), {
            type: 'bar',
            data: {
                labels: data.event_comparison.map(e => e.Event.substring(0, 35)),
                datasets: [{
                    label: 'Total Profit',
                    data: data.event_comparison.map(e => e.Profit),
                    backgroundColor: colors.success
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        ticks: {
                            callback: (value) => '$' + (value/1000).toFixed(1) + 'K'
                        }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('eventMarginChart'), {
            type: 'bar',
            data: {
                labels: data.event_comparison.map(e => e.Event.substring(0, 25)),
                datasets: [{
                    label: 'Profit Margin %',
                    data: data.event_comparison.map(e => e.Margin),
                    backgroundColor: colors.warning
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        ticks: {
                            callback: (value) => value.toFixed(1) + '%'
                        }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('eventTicketsChart'), {
            type: 'bar',
            data: {
                labels: data.event_comparison.map(e => e.Event.substring(0, 25)),
                datasets: [{
                    label: 'Total Tickets Sold',
                    data: data.event_comparison.map(e => e.Total_Tickets),
                    backgroundColor: colors.info
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                }
            }
        });
        
        // Venue Scatter
        new Chart(document.getElementById('venueScatterChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Venues',
                    data: data.venue_comparison.map(v => ({
                        x: v.Transactions,
                        y: v.Margin,
                        r: Math.sqrt(v.Profit) / 10
                    })),
                    backgroundColor: colors.primary
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: (context) => {
                                const v = data.venue_comparison[context.dataIndex];
                                return [
                                    v.Venue,
                                    'Transactions: ' + formatNumber(v.Transactions),
                                    'Margin: ' + v.Margin.toFixed(1) + '%',
                                    'Profit: ' + formatCurrency(v.Profit)
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Number of Transactions' }
                    },
                    y: {
                        title: { display: true, text: 'Profit Margin %' }
                    }
                }
            }
        });
        
        // Generate venue details
        const venueDetailsContainer = document.getElementById('venueDetailsContainer');
        data.venue_details.forEach(venue => {
            const card = document.createElement('div');
            card.className = 'venue-card';
            
            let topEventsHtml = '<table><thead><tr><th>Event</th><th>Profit</th><th>Transactions</th></tr></thead><tbody>';
            venue.Top_Events.slice(0, 3).forEach(e => {
                topEventsHtml += `<tr><td>${e.Event.substring(0, 50)}</td><td>${formatCurrency(e.Profit)}</td><td>${e['PO #']}</td></tr>`;
            });
            topEventsHtml += '</tbody></table>';
            
            card.innerHTML = `
                <h3>${venue.Venue}</h3>
                <div class="stat-grid">
                    <div class="stat-item">
                        <div class="stat-label">Transactions</div>
                        <div class="stat-value">${formatNumber(venue.Total_Transactions)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total Profit</div>
                        <div class="stat-value">${formatCurrency(venue.Total_Profit)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Profit Margin</div>
                        <div class="stat-value">${venue.Profit_Margin.toFixed(1)}%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Avg Ticket Price</div>
                        <div class="stat-value">${formatCurrency(venue.Avg_Ticket_Price)}</div>
                    </div>
                </div>
                <strong style="display: block; margin-top: 15px; margin-bottom: 10px;">Top Events at This Venue:</strong>
                ${topEventsHtml}
            `;
            venueDetailsContainer.appendChild(card);
        });
        
        // Generate event details
        const eventDetailsContainer = document.getElementById('eventDetailsContainer');
        data.event_details.forEach(event => {
            const card = document.createElement('div');
            card.className = 'event-card';
            
            let venuesHtml = '<table><thead><tr><th>Venue</th><th>Profit</th><th>Transactions</th></tr></thead><tbody>';
            event.Venues.slice(0, 3).forEach(v => {
                venuesHtml += `<tr><td>${v.Venue.substring(0, 40)}</td><td>${formatCurrency(v.Profit)}</td><td>${v['PO #']}</td></tr>`;
            });
            venuesHtml += '</tbody></table>';
            
            card.innerHTML = `
                <h3>${event.Event}</h3>
                <div class="stat-grid">
                    <div class="stat-item">
                        <div class="stat-label">Transactions</div>
                        <div class="stat-value">${formatNumber(event.Total_Transactions)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total Profit</div>
                        <div class="stat-value">${formatCurrency(event.Total_Profit)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total Tickets</div>
                        <div class="stat-value">${formatNumber(event.Total_Tickets)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Avg Ticket Price</div>
                        <div class="stat-value">${formatCurrency(event.Avg_Ticket_Price)}</div>
                    </div>
                </div>
                <strong style="display: block; margin-top: 15px; margin-bottom: 10px;">Top Venues for This Event:</strong>
                ${venuesHtml}
            `;
            eventDetailsContainer.appendChild(card);
        });
        
        // Venue comparison table
        const venueTable = document.getElementById('venueComparisonTable');
        let venueTableHtml = '<thead><tr><th>Venue</th><th>Transactions</th><th>Profit</th><th>Revenue</th><th>Margin %</th><th>Avg Price</th><th>Success Rate</th></tr></thead><tbody>';
        data.venue_comparison.forEach(v => {
            venueTableHtml += `<tr>
                <td>${v.Venue}</td>
                <td>${formatNumber(v.Transactions)}</td>
                <td class="${v.Profit > 0 ? 'positive' : 'negative'}">${formatCurrency(v.Profit)}</td>
                <td>${formatCurrency(v.Revenue)}</td>
                <td>${v.Margin.toFixed(1)}%</td>
                <td>${formatCurrency(v.Avg_Price)}</td>
                <td>${v.Profitable_Rate.toFixed(1)}%</td>
            </tr>`;
        });
        venueTableHtml += '</tbody>';
        venueTable.innerHTML = venueTableHtml;
        
        // Event comparison table
        const eventTable = document.getElementById('eventComparisonTable');
        let eventTableHtml = '<thead><tr><th>Event</th><th>Transactions</th><th>Profit</th><th>Revenue</th><th>Margin %</th><th>Tickets Sold</th><th>Avg Price</th></tr></thead><tbody>';
        data.event_comparison.forEach(e => {
            eventTableHtml += `<tr>
                <td>${e.Event}</td>
                <td>${formatNumber(e.Transactions)}</td>
                <td class="${e.Profit > 0 ? 'positive' : 'negative'}">${formatCurrency(e.Profit)}</td>
                <td>${formatCurrency(e.Revenue)}</td>
                <td>${e.Margin.toFixed(1)}%</td>
                <td>${formatNumber(e.Total_Tickets)}</td>
                <td>${formatCurrency(e.Avg_Price)}</td>
            </tr>`;
        });
        eventTableHtml += '</tbody>';
        eventTable.innerHTML = eventTableHtml;
        
        // Venue-Event Matrix table
        const matrixTable = document.getElementById('venueEventMatrixTable');
        let matrixHtml = '<thead><tr><th>Venue</th><th>Event</th><th>Transactions</th><th>Total Profit</th><th>Avg Profit</th><th>Margin %</th></tr></thead><tbody>';
        data.venue_event_matrix.forEach(m => {
            matrixHtml += `<tr>
                <td>${m.Venue.substring(0, 30)}</td>
                <td>${m.Event.substring(0, 40)}</td>
                <td>${formatNumber(m.Transactions)}</td>
                <td class="${m.Profit > 0 ? 'positive' : 'negative'}">${formatCurrency(m.Profit)}</td>
                <td>${formatCurrency(m.Avg_Profit)}</td>
                <td>${m.Margin.toFixed(1)}%</td>
            </tr>`;
        });
        matrixHtml += '</tbody>';
        matrixTable.innerHTML = matrixHtml;
    </script>
</body>
</html>